<html>
  <head>
    <link href="style.css" type="text/css" rel="stylesheet" />
  </head>
  <body>
    <div class="main">
      <div class="leftItem">
        <input type="file" id="file" onchange="addImg(this.files)" />
        <label for="file">upload</label>
        <div class="colorData">
          <label>координаты:</label>
          <span id="coord"></span>
          <label> цвет hex:</label>
          <span id="color"></span>
          <label> цвет rgba:</label>
          <span id="rgba"></span>
          <div id="output"></div>
        </div>
      </div>
      <img src="" />
      <canvas id="canv"></canvas>
    </div>
  </body>
  <script>
    let data;
    function addImg(a) {
      let img = document.querySelector("img");
      img.src = URL.createObjectURL(a[0]);
      img.onload = () => calculate();
    }

    function calculate() {
      let canv = document.getElementById("canv");
      let img = document.querySelector("img");
      canv.width = img.width;
      canv.height = img.height;
      let qqq = canv.getContext("2d");
      qqq.drawImage(img, 0, 0, img.width, img.height);

      img.style.visibility = "hidden";

      data = qqq.getImageData(10, 10, 700, 400);
      //   console.log(data);
      canv.addEventListener("mousemove", (e) => {
        showColor(qqq, e.offsetX, e.offsetY);
      });
      canv.addEventListener("click", (e) => {
        showColor(qqq, e.offsetX, e.offsetY, true);
      });
    }

    function showColor(context, x, y, isClicked) {
      let localData = context.getImageData(x, y, 1, 1).data;
      // console.log(localData);
      document.getElementById("coord").innerHTML = `${x}  ${y}`;
      document.getElementById("color").innerHTML = `${localData[0].toString(16)} ${localData[1].toString(16)} ${localData[2].toString(16)}`;
      document.getElementById("rgba").innerHTML = `${localData[0]} ${localData[1]} ${localData[2]}`;
      document.getElementById("output").style.backgroundColor = `#${localData[0].toString(16)}${localData[1].toString(16)}${localData[2].toString(16)}`;

      if (isClicked) {
        console.log(`#${localData[0].toString(16)}${localData[1].toString(16)}${localData[2].toString(16)}`);
      }
    }
  </script>
</html>
